<div class="map-container">
  <div class="wrapper">

    <div id="map" style="width: 100%; height: 600px;"></div>

    <% content_for(:after_js) do %>
      <%= javascript_tag do %>
        $(document).on('ready', function() {

          navigator.geolocation.getCurrentPosition(function(location)
          {
            var $lat = location.coords.latitude;
            var $lng = location.coords.longitude;

            var mapOptions = {
              center: new google.maps.LatLng($lat, $lng),
              zoom: 18
            };

            var handler = Gmaps.build('Google');
            handler.buildMap( { provider: mapOptions, internal: { id: 'map' } }, function() {
              markers = handler.addMarkers(<%= raw @hash.to_json %>);
            });

          }); <!-- fin du navigator.geolocation -->

        }); <!-- fin du document.ready -->
      <% end %>
    <% end %>


  </div> <!- end wrapper ->
</div> <!- end map-container ->






